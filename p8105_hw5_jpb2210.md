Data Science - Homework \#5
================
Jon Brock - JPB2210

  - [Problem \#1](#problem-1)
  - [Problem \#2](#problem-2)
  - [Problem \#3](#problem-3)
  - [Homework Resources](#homework-resources)

``` r
library(tidyverse)
```

-----

## Problem \#1

###### (*20 points*)

##### *Writing a function*

``` r
set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

``` r
species_replace <- function(x, y) {
    
    pull(x, y) %>% replace_na("virginica")
    
}

species_replace(iris_with_missing, "Species")
```

    ##   [1] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##   [6] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [11] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [16] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [21] "setosa"     "virginica"  "setosa"     "setosa"     "virginica" 
    ##  [26] "setosa"     "virginica"  "setosa"     "setosa"     "setosa"    
    ##  [31] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [36] "setosa"     "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [41] "setosa"     "virginica"  "setosa"     "setosa"     "setosa"    
    ##  [46] "virginica"  "setosa"     "setosa"     "setosa"     "setosa"    
    ##  [51] "virginica"  "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [56] "versicolor" "virginica"  "versicolor" "virginica"  "versicolor"
    ##  [61] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [66] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [71] "versicolor" "virginica"  "versicolor" "versicolor" "versicolor"
    ##  [76] "versicolor" "versicolor" "versicolor" "versicolor" "virginica" 
    ##  [81] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [86] "versicolor" "versicolor" "versicolor" "versicolor" "versicolor"
    ##  [91] "versicolor" "versicolor" "versicolor" "virginica"  "versicolor"
    ##  [96] "versicolor" "versicolor" "versicolor" "versicolor" "virginica" 
    ## [101] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [106] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [111] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [116] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [121] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [126] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [131] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [136] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [141] "virginica"  "virginica"  "virginica"  "virginica"  "virginica" 
    ## [146] "virginica"  "virginica"  "virginica"  "virginica"  "virginica"

``` r
# TEST CODE BELOW


#code_test <- function(x) {
    
#    modify_at(.x, .Species, replace_na("virginica"))
    
#}

#code_test(iris_with_missing)
```

-----

## Problem \#2

###### (*25 points*)

##### *Tidy and plot longitudinal data*

``` r
csv_files <- list.files("./data", pattern = "*.csv", full.names = TRUE) %>%  
    set_names(nm = basename(.)) %>% 
    map_df(read_csv, col_names = TRUE, col_types = cols(), .id = "filename") %>% 
    mutate(
        arm = str_sub(filename, 1,3),
        id = str_sub(filename, 5,6)) %>% 
    select(arm, id, week_1:week_8) %>% 
    mutate(arm = case_when(
        arm == "con" ~ "control_participant",
        arm == "exp" ~ "experimental_participant")) %>% 
    unite(participant, c(arm, id), remove = TRUE)


csv_files
```

    ## # A tibble: 20 x 9
    ##    participant      week_1 week_2 week_3 week_4 week_5 week_6 week_7 week_8
    ##    <chr>             <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>
    ##  1 control_partici…   0.2  -1.31    0.66   1.96   0.23   1.09   0.05   1.94
    ##  2 control_partici…   1.13 -0.88    1.07   0.17  -0.83  -0.31   1.58   0.44
    ##  3 control_partici…   1.77  3.11    2.22   3.26   3.31   0.89   1.88   1.01
    ##  4 control_partici…   1.04  3.66    1.22   2.33   1.47   2.7    1.87   1.66
    ##  5 control_partici…   0.47 -0.580  -0.09  -1.37  -0.32  -2.17   0.45   0.48
    ##  6 control_partici…   2.37  2.5     1.59  -0.16   2.08   3.07   0.78   2.35
    ##  7 control_partici…   0.03  1.21    1.13   0.64   0.49  -0.12  -0.07   0.46
    ##  8 control_partici…  -0.08  1.42    0.09   0.36   1.18  -1.16   0.33  -0.44
    ##  9 control_partici…   0.08  1.24    1.44   0.41   0.95   2.75   0.3    0.03
    ## 10 control_partici…   2.14  1.15    2.52   3.44   4.26   0.97   2.73  -0.53
    ## 11 experimental_pa…   3.05  3.67    4.84   5.8    6.33   5.46   6.38   5.91
    ## 12 experimental_pa…  -0.84  2.63    1.64   2.58   1.24   2.32   3.11   3.78
    ## 13 experimental_pa…   2.15  2.08    1.82   2.84   3.36   3.61   3.37   3.74
    ## 14 experimental_pa…  -0.62  2.54    3.78   2.73   4.49   5.82   6      6.49
    ## 15 experimental_pa…   0.7   3.33    5.34   5.57   6.9    6.66   6.24   6.95
    ## 16 experimental_pa…   3.73  4.08    5.4    6.41   4.87   6.09   7.66   5.83
    ## 17 experimental_pa…   1.18  2.35    1.23   1.17   2.02   1.61   3.13   4.88
    ## 18 experimental_pa…   1.37  1.43    1.84   3.6    3.8    4.72   4.68   5.7 
    ## 19 experimental_pa…  -0.4   1.08    2.66   2.7    2.8    2.64   3.51   3.27
    ## 20 experimental_pa…   1.09  2.8     2.8    4.3    2.25   6.57   6.09   4.64

-----

## Problem \#3

###### (*35 points*)

##### *Create and plot simulations*

-----

## Homework Resources

*Given the enormous headache of trying to figure out this homework, I
relied much more heavily on online resources than previous homeworks. I
felt it necessary to cite all of my resources. They are listed below.*

[https://www.gerkelab.com/blog/2018/09/import-directory-csv-purrr-readr/]()  
[https://serialmentor.com/blog/2016/6/13/reading-and-combining-many-tidy-data-files-in-R]()  
[https://www.hvitfeldt.me/blog/purrr-tips-and-tricks/\#sources]()  
[https://github.com/STAT545-UBC/Discussion/issues/398]()  
[https://gist.github.com/ColinFay/d74d331825868b181860212cd1577b69]()  
[https://gist.github.com/ColinFay/d74d331825868b181860212cd1577b69]()  
[https://lsru.github.io/tv\_course/TD\_purrr\_solution.html]()
[https://github.com/DanOvando/learn-purrr]()
[https://stats.idre.ucla.edu/r/faq/how-can-i-visualize-longitudinal-data-in-ggplot2/]()
[https://community.rstudio.com/t/using-case-when-over-multiple-columns/17206]()
